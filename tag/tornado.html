<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>tornado - mike.depalatis.net</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




    <meta name="author" content="Michael V. DePalatis" />
    <meta name="keywords" content="tornado" />

    <!-- Enable latex plugin -->


    <!-- Open Graph tags -->
        <meta property="og:site_name" content="mike.depalatis.net" />
        <meta property="og:type" content="website"/>
        <meta property="og:title" content="mike.depalatis.net"/>
        <meta property="og:url" content=".."/>
        <meta property="og:description" content="mike.depalatis.net"/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="../theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../theme/css/pygments/default.css" rel="stylesheet">
    <link rel="stylesheet" href="../theme/css/style.css" type="text/css"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../" class="navbar-brand">
mike.depalatis.net            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="../">
                             About
                          </a></li>
                         <li><a href="../photography.html">
                             Photography
                          </a></li>
                         <li><a href="../research.html">
                             Research
                          </a></li>
                         <li><a href="../resources.html">
                             Links
                          </a></li>
                        <li >
                            <a href="../category/blog.html">Blog</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-lg-12">

            <article>
                <h2><a href="../running-possibly-blocking-code-like-a-tornado-coroutine.html">Running (possibly) blocking code like a Tornado coroutine</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-08-03T19:54:00+02:00"> 2015-08-03</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="../tag/python.html">python</a>
        /
	<a href="../tag/tornado.html">tornado</a>
        /
	<a href="../tag/async.html">async</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>One of the main benefits of using the <a href="http://www.tornadoweb.org/en/stable/">Tornado</a> web server is that it is
(normally) a single-threaded, asynchronous framework that can rely on
coroutines for concurrency. Many drivers already exist to provide a
client library utilizing the Tornado event loop and coroutines (e.g.,
the <a href="https://github.com/mongodb/motor/">Motor</a> <a href="https://www.mongodb.org/">MongoDB</a> driver).</p>
<p>To write your own coroutine-friendly code for Tornado, there are a few
different options available, all requiring that you somehow wrap
blocking calls within a Future so as to allow the event loop to continue
executing. Here, I demonstrate one recipe to do just this by utilizing
<code>Executor</code> objects from the <code>concurrent.futures</code> module. We start with
the imports:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.concurrent</span> <span class="kn">import</span> <span class="n">run_on_executor</span><span class="p">,</span> <span class="n">futures</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
</pre></div>


<p>We will be using the <code>run_on_executor</code> decorator which requires that the
class whose methods we decorate have some type of <code>Executor</code> attribute
(the default is to use the <code>executor</code> attribute, but a different
<code>Executor</code> can be used with a keyword argument passed to the decorator).
We'll create a class to run our asynchronous tasks and give it a
<code>ThreadPoolExecutor</code> for executing tasks. In this contrived example, our
long running task just sleeps ...</p>
                    <a class="btn btn-default btn-xs" href="../running-possibly-blocking-code-like-a-tornado-coroutine.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="../background-tasks-with-tornado.html">Background tasks with Tornado</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-02-28T14:32:00+01:00"> 2015-02-28</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="../tag/python.html">python</a>
        /
	<a href="../tag/tornado.html">tornado</a>
        /
	<a href="../tag/lab.html">lab</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>I have been using <a href="http://www.tornadoweb.org/en/stable/">Tornado</a> lately for distributed control of
devices in the lab where an asynchronous framework is advantageous. In
particular, we have a <a href="http://www.highfinesse.com/">HighFinesse</a> <a href="http://www.highfinesse.com/en/wavelengthmeter/">wavelength meter</a>
which we use to monitor and stabilize several lasers (up to 14 at a
time). Previously, a custom server for controlling this wavemeter was
written using <a href="https://twistedmatrix.com/trac/">Twisted</a>, but that has proven difficult to upgrade,
distribute, and maintain.</p>
<p>One thing that is common for such a control scenario is that data
needs to be refreshed continuously while still allowing incoming
connections from clients and appropriately executing remote procedure
calls. One method would be to periodically interrupt the Tornado IO
loop to refresh data (and in fact, Tornado has a class to make this
easy for you in <code>tornado.ioloop.PeriodicCallback</code>). This can be fine
if the data refreshing does not take too much time, but all other
operations will be blocked until the callback is finished, which can
be a problem if the refreshing operation is slow. Another option is to
have an additional thread separate from the Tornado IO loop that
handles refreshing data. This certainly works, but adds the complexity
of needing to use thread-safe communications to stop the thread when ...</p>
                    <a class="btn btn-default btn-xs" href="../background-tasks-with-tornado.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="../using-websockets-with-flask-via-tornado.html">Using websockets with Flask via Tornado</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-12-15T19:44:00+01:00"> 2014-12-15</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="../tag/python.html">python</a>
        /
	<a href="../tag/flask.html">flask</a>
        /
	<a href="../tag/tornado.html">tornado</a>
        /
	<a href="../tag/javascript.html">javascript</a>
        /
	<a href="../tag/websockets.html">websockets</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>I've been working on some projects for the lab that involve remotely
controlling hardware to perform various tasks. Since the hardware in
question is shared between different experiments, some sort of
asynchronous solution is needed, and a web-based client coupled with
<a href="https://en.wikipedia.org/wiki/WebSocket">websockets</a> seemed to be the best bet (this also leaves the option
open in the future to write a standalone client that is not
browser-based if desired).</p>
<p>There is no shortage of web frameworks for Python. Some of the more
popular ones are <a href="https://www.djangoproject.com/">Django</a>, <a href="http://flask.pocoo.org/">Flask</a>, <a href="http://tornadoweb.org/">Tornado</a>, and
<a href="http://www.pylonsproject.org/">Pyramid</a>. Of these, I greatly prefer Flask for a number of reasons:</p>
<ul>
<li>Very thorough and easy to read documentation, including "snippets"
  with helpful tips and a very helpful community.</li>
<li>Extreme ease of use for both small and large projects.</li>
<li>Great use of decorators to further ease development.</li>
<li>A large number of extensions to build up a complex project without
  requiring overhead for simple projects.</li>
</ul>
<p>This is not to say that the other options are bad, but having looked
at all of them, Flask suits me best. The one problem: only Tornado
directly supports websockets since it is both an HTTP server and a web
framework in one, whereas the others utilize ...</p>
                    <a class="btn btn-default btn-xs" href="../using-websockets-with-flask-via-tornado.html">more ...</a>
                </div>
            </article>
            <hr/>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Michael V. DePalatis
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="../theme/js/jquery.min.js"></script>
<script src="../theme/js/bootstrap.min.js"></script>
<script src="../theme/js/respond.min.js"></script>
<script src="../theme/js/admonitions.js"></script>

</body>
</html>