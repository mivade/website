<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Importing one Mercurial repository into another - mike.depalatis.net</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="./importing-one-mercurial-repository-into-another.html">

        <meta name="author" content="Michael V. DePalatis" />
        <meta name="keywords" content="mercurial" />
        <meta name="description" content="In the ion trap group, we usually use Mercurial for version controlling software we write for experimental control, data analysis, and so on. This post outlines how to import the full history of one repository into another. This can be useful for cases where it makes sense to move a ..." />

    <!-- Enable latex plugin -->




    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
mike.depalatis.net            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./">
                             About
                          </a></li>
                         <li><a href="./photography.html">
                             Photography
                          </a></li>
                         <li><a href="./research.html">
                             Research
                          </a></li>
                         <li><a href="./resources.html">
                             Links
                          </a></li>
                        <li class="active">
                            <a href="./category/blog.html">Blog</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="./archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./importing-one-mercurial-repository-into-another.html"
                       rel="bookmark"
                       title="Permalink to Importing one Mercurial repository into another">
                        Importing one Mercurial repository into another
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-11-04T00:00:00+01:00"> 2015-11-04</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="./tag/mercurial.html">mercurial</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <hr />
<p>In the
<a href="http://phys.au.dk/forskning/forskningsomraader/amo/the-ion-trap-group/">ion trap group</a>,
we usually use <a href="https://www.mercurial-scm.org/">Mercurial</a> for version controlling software we write
for experimental control, data analysis, and so on. This post outlines
how to import the full history of one repository into another. This
can be useful for cases where it makes sense to move a sub-project
directly into its parent, for example.</p>
<h2>Convert the soon-to-be child repository</h2>
<p>With the Mercurial <code>convert</code> extension, you can rename branches, move,
and filter files. As an example, say we have a repo with only the
<code>default</code> branch which is to be imported into a super-repository.</p>
<p>For starters, we will want all our files in the child repo to be in a
subdirectory of the parent repo and not include the child's
<code>.hgignore</code>. To do this, create a file <code>filemap.txt</code> with the
following contents:</p>
<div class="highlight"><pre>rename . child
exclude .hgignore
</pre></div>


<p>The first line will move all files in the repo's top level into a
directory named <code>child</code>.</p>
<p>Next, optionally create a <code>branchmap.txt</code> file for renaming the
<code>default</code> branch to something else:</p>
<div class="highlight"><pre>default child-repo
</pre></div>


<p>Now convert:</p>
<div class="highlight"><pre>hg convert --filemap branchmap.txt --branchmap branchmap.txt child/ converted/
</pre></div>


<h2>Pull in the converted repository</h2>
<p>From the parent repo:</p>
<div class="highlight"><pre>hg pull -f ../converted
</pre></div>


<p>Ensure the child commits are in the draft phase with:</p>
<div class="highlight"><pre>hg phase -f --draft -r &lt;first&gt;:&lt;last&gt;
</pre></div>


<h2>Rebase as appropriate</h2>
<div class="highlight"><pre>hg rebase -s &lt;child rev&gt; -d &lt;parent rev&gt;
</pre></div>


<p>To keep the child's changed branch name, use the <code>--keepbranches</code>
option.</p>
<h2>References</h2>
<ul>
<li>https://mercurial.selenic.com/wiki/ConvertExtension</li>
<li>https://mercurial.selenic.com/wiki/Phases</li>
<li>https://mercurial.selenic.com/wiki/RebaseExtension</li>
<li>https://stackoverflow.com/questions/3214717/how-can-i-import-a-mercurial-repo-including-history-into-another-mercurial-rep</li>
<li>https://stackoverflow.com/questions/3338672/mercurial-convert-clones-to-branches</li>
</ul>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Michael V. DePalatis
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>
<script src="./theme/js/bootstrap.min.js"></script>
<script src="./theme/js/respond.min.js"></script>
<script src="./theme/js/admonitions.js"></script>

</body>
</html>